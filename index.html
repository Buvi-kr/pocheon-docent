<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Live2D Universal Loader</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; background-color: #333; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: white; font-family: sans-serif; }
        canvas { display: block; }
        #status { position: absolute; top: 20px; color: yellow; font-size: 1.2rem; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; }
    </style>
    
    <script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/datsver/live2d-widget@latest/live2d.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/6.5.2/browser/pixi.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/pixi-live2d-display@0.4.0/dist/index.min.js"></script>
</head>
<body>

    <div id="status">상태: 초기화 중...</div>
    <canvas id="canvas"></canvas>

    <script>
        // 1. 모델 경로 설정 (스크린샷에 있는 'Hiyori' 모델 사용)
        // Cubism 4 모델이므로 화질과 움직임이 가장 좋습니다.
        const MODEL_URL = 'https://cdn.jsdelivr.net/gh/Live2D/CubismWebSamples@develop/Samples/Resources/Hiyori/Hiyori.model3.json';

        (async function () {
            const statusEl = document.getElementById('status');
            
            // 2. 라이브러리 로드 체크
            if (!window.PIXI) { statusEl.innerText = "오류: PIXI 로드 실패"; return; }
            if (!window.PIXI.live2d) { statusEl.innerText = "오류: Live2D 플러그인 로드 실패 (CDN 문제)"; return; }

            // 3. Pixi Application 생성
            const app = new PIXI.Application({
                view: document.getElementById('canvas'),
                autoStart: true,
                resizeTo: window,
                backgroundAlpha: 0
            });

            statusEl.innerText = "상태: 모델 다운로드 중...";

            try {
                // 4. 모델 로드 (Cubism 4 자동 감지)
                const model = await PIXI.live2d.Live2DModel.from(MODEL_URL);

                // 5. 화면 중앙 배치
                model.anchor.set(0.5);
                model.x = window.innerWidth * 0.5;
                model.y = window.innerHeight * 0.5 + 150; // 위치 미세 조정
                model.scale.set(0.25); // 크기 조정

                // 6. 상호작용 (터치 시 반응)
                model.interactive = true;
                model.on('pointertap', () => {
                    model.motion('TapBody'); // Hiyori 전용 모션
                    console.log("터치됨!");
                });

                app.stage.addChild(model);
                statusEl.innerText = "상태: 로드 성공! (화면 터치해보세요)";
                statusEl.style.color = "#4caf50"; // 녹색

            } catch (error) {
                console.error(error);
                statusEl.innerText = "상태: 모델 로드 실패 (콘솔 확인)";
                statusEl.style.color = "red";
            }
        })();
    </script>
</body>
</html>
